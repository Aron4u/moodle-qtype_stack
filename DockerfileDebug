FROM timimages/stack

ENV APT_INSTALL="DEBIAN_FRONTEND=noninteractive apt-get -qq update && DEBIAN_FRONTEND=noninteractive apt-get -q install --no-install-recommends -y" \
    APT_CLEANUP="rm -rf /var/lib/apt/lists /usr/share/doc ~/.cache /var/cache/oracle-* /var/cache/apk /tmp/*"

USER root
RUN bash -c "${APT_INSTALL} openssh-server && ${APT_CLEANUP}"

RUN pecl install xdebug  && docker-php-ext-enable xdebug
RUN apt-get update
RUN apt-get install nano -y
RUN apt-get update
RUN cp  /usr/local/etc/php/php.ini-development  /usr/local/etc/php/php.ini
# RUN echo 'zend_extension=/usr/local/lib/php/extensions/no-debug-non-zts-20151012/xdebug.so\n\
# [XDebug]\n\
# xdebug.remote_host = 192.168.59.6\n\
# xdebug.remote_enable = 1\n\
# xdebug.remote_autostart = 1\n' >>/usr/local/etc/php/php.ini

RUN mkdir /var/run/sshd
RUN echo 1 | pam-auth-update
RUN echo 'root:test' | chpasswd
RUN sed -i 's/#PermitRootLogin prohibit-password/PermitRootLogin yes/' /etc/ssh/sshd_config
EXPOSE 22
CMD service ssh start 

ENTRYPOINT  /var/www/html/entrypoint_install_and_run.sh

